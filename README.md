
# RustySquire

<img align="right" width="150" height="150" src="img/rusty_squire.png">

RustySquire is an command-line application written in Rust to aggregate the output data generated by [SQuIRE](https://github.com/wyang17/SQuIRE) if run individually per sample.

<img align="left" width="150" height="150" src="img/rusty_squires.png" style="margin-right: 25px">

SQuIRE organises its output data in text files, all have to be within the same _directory_
* [sample]_TEcounts.txt -> count data for individual TE loci
* [sample]_Refgenecounts.txt -> count data for individual reference genes
* [sample]_subFcounts.txt -> count data for TE subfamilies

The problem is that these text files are not ordered the same for all samples and might contain thousands of entries. If using SQuIRE for single-cell based experiments, building aggregated data becomes a huge problem.

<img align="right" width="150" height="150" src="img/rusty_squire_virus.png">

Rusty Squire outputs three files
* [directory].TEcounts.tsv
* [directory].Refgenecounts.tsv
* [directory].subFcounts.tsv

The files always start with the rowid followed by metadata colums, followed by the float value for each individual file. The filenames are given in the headerrow.

> :bulb: Effectively, RustySquire performs a "pivot wide" on all files of a defined function within a given folder.

> :sparkler: Images generated by Gemini 2.5 Pro

## Installation
* Install Rust: [see rust-lang.org](https://rust-lang.org/tools/install/)
* Compile Application: rustc src/main.rs -o rusty_squire

## Usage

```{bash}
./rusty_squire [target_folder]
```

## further developments
RustySquire could easily be adapted to also aggregate data of other origin with a similar problem.
```{rust}
let ref_gene_counts = FileDefinition {
        postfix: "_refGenecounts.txt".parse().unwrap(), //postfix of a file with this format
        rowid_col: 3, //row id (0-based) with the id of this row, e.g. Geneid or TE-id
        metadata_cols: vec!(0,1,2), // row ids (0-based) with metadata to extract
        value_col: 6, // row id with a float value to be aggregated
        skip: 0, // number of rows to skip (e.g. header rows)
        ncols: 7 // total number of columns in a row
    };
```


## Author and License
&copy; by Jeremy Deuel <jeremy.deuel@usz.ch> October 2025

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a [copy](LICENSE) of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.